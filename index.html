<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>MingleNow | Chat with Strangers Instantly</title>
<meta name="description" content="Meet someone new in seconds. Random video or text chats ‚Äî simple, fast, and anonymous.">
<meta property="og:title" content="MingleNow ‚Äî Chat with Strangers">
<meta property="og:description" content="Random video & text chat with interest matching. Meet people worldwide.">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üí¨</text></svg>">
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
  :root {
    --bg: #0a0a0f; --surface: #12121a; --surface-2: #1a1a26; --surface-3: #222233;
    --accent: #6c5ce7; --accent-glow: #a29bfe; --green: #00e676; --red: #e84393;
    --text: #eeeef0; --text-dim: #8888a0; --border: rgba(255,255,255,0.06);
    --radius: 16px;
  }
  html { scroll-behavior: smooth; }
  body {
    font-family: 'Outfit', sans-serif; background: var(--bg); color: var(--text);
    min-height: 100vh; overflow-x: hidden; -webkit-font-smoothing: antialiased;
  }

  /* ‚ïê‚ïê‚ïê BG ‚ïê‚ïê‚ïê */
  .bg-orbs { position: fixed; inset: 0; z-index: 0; pointer-events: none; overflow: hidden; }
  .bg-orbs .orb { position: absolute; border-radius: 50%; filter: blur(120px); opacity: 0.25; animation: orbFloat 20s ease-in-out infinite alternate; }
  .bg-orbs .orb:nth-child(1) { width: 600px; height: 600px; background: var(--accent); top: -200px; left: -100px; }
  .bg-orbs .orb:nth-child(2) { width: 500px; height: 500px; background: #e84393; bottom: -200px; right: -100px; animation-delay: -7s; }
  .bg-orbs .orb:nth-child(3) { width: 400px; height: 400px; background: #00b894; top: 50%; left: 50%; transform: translate(-50%,-50%); animation-delay: -14s; opacity: 0.12; }
  @keyframes orbFloat { 0%{transform:translate(0,0) scale(1)} 50%{transform:translate(60px,-40px) scale(1.1)} 100%{transform:translate(-20px,30px) scale(0.95)} }
  body::before { content:''; position:fixed; inset:0; z-index:1; pointer-events:none; background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E"); opacity:0.5; }

  /* ‚ïê‚ïê‚ïê PAGES ‚ïê‚ïê‚ïê */
  .page { display: none; position: relative; z-index: 2; min-height: 100vh; }
  .page.active { display: block; }
  .page-chat { display: none; }
  .page-chat.active { display: flex; flex-direction: column; height: 100vh; height: 100dvh; }

  /* ‚ïê‚ïê‚ïê NAV ‚ïê‚ïê‚ïê */
  nav { display:flex; align-items:center; justify-content:space-between; padding:20px 40px; max-width:1200px; margin:0 auto; }
  .logo { font-weight:800; font-size:1.6rem; letter-spacing:-0.5px; display:flex; align-items:center; gap:8px; cursor:pointer; }
  .logo-icon { width:36px; height:36px; background:linear-gradient(135deg,var(--accent),#e84393); border-radius:10px; display:flex; align-items:center; justify-content:center; font-size:1.1rem; }
  .online-badge { display:flex; align-items:center; gap:8px; background:var(--surface); border:1px solid var(--border); padding:8px 16px; border-radius:100px; font-size:0.9rem; font-weight:600; }
  .online-dot { width:8px; height:8px; background:var(--green); border-radius:50%; animation:pulse 2s ease-in-out infinite; box-shadow:0 0 8px var(--green); }
  @keyframes pulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:0.6;transform:scale(0.85)} }

  /* ‚ïê‚ïê‚ïê HERO ‚ïê‚ïê‚ïê */
  .hero { max-width:1200px; margin:0 auto; padding:80px 40px 60px; text-align:center; }
  .hero h1 { font-size:clamp(2.8rem,7vw,5.5rem); font-weight:900; line-height:1.05; letter-spacing:-2px; margin-bottom:24px; background:linear-gradient(135deg,#fff 0%,#ccc 50%,var(--accent-glow) 100%); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }
  .hero p { font-size:1.2rem; color:var(--text-dim); max-width:560px; margin:0 auto 48px; line-height:1.6; font-weight:300; }

  /* ‚ïê‚ïê‚ïê MODE CARDS ‚ïê‚ïê‚ïê */
  .mode-cards { display:flex; gap:20px; justify-content:center; flex-wrap:wrap; margin-bottom:40px; }
  .mode-card { background:var(--surface); border:1px solid var(--border); border-radius:var(--radius); padding:40px 50px; cursor:pointer; transition:all 0.3s cubic-bezier(0.4,0,0.2,1); position:relative; overflow:hidden; text-decoration:none; color:var(--text); min-width:220px; }
  .mode-card::before { content:''; position:absolute; inset:0; background:linear-gradient(135deg,var(--accent),#e84393); opacity:0; transition:opacity 0.3s; }
  .mode-card:hover { transform:translateY(-4px); border-color:var(--accent); box-shadow:0 20px 60px rgba(108,92,231,0.15); }
  .mode-card:hover::before { opacity:0.08; }
  .mode-card-icon { font-size:2.4rem; margin-bottom:12px; position:relative; z-index:1; }
  .mode-card-title { font-size:1.3rem; font-weight:700; position:relative; z-index:1; margin-bottom:4px; }
  .mode-card-sub { font-size:0.85rem; color:var(--text-dim); position:relative; z-index:1; }
  .or-divider { display:flex; align-items:center; font-size:0.85rem; color:var(--text-dim); font-weight:500; letter-spacing:2px; text-transform:uppercase; }

  /* ‚ïê‚ïê‚ïê INTERESTS ‚ïê‚ïê‚ïê */
  .interests-section { max-width:560px; margin:0 auto 20px; }
  .interests-label { font-size:0.9rem; color:var(--text-dim); margin-bottom:12px; }
  .interests-input-wrap { display:flex; align-items:center; gap:8px; background:var(--surface); border:1px solid var(--border); border-radius:12px; padding:12px 16px; transition:border-color 0.3s; flex-wrap:wrap; }
  .interests-input-wrap:focus-within { border-color:var(--accent); }
  .interests-input-wrap input { flex:1; background:none; border:none; color:var(--text); font-family:'Outfit',sans-serif; font-size:0.95rem; outline:none; min-width:120px; }
  .interests-input-wrap input::placeholder { color:var(--text-dim); }
  .tag { background:rgba(108,92,231,0.15); color:var(--accent-glow); padding:4px 12px; border-radius:100px; font-size:0.8rem; font-weight:500; display:flex; align-items:center; gap:6px; white-space:nowrap; animation:tagIn 0.2s ease; }
  @keyframes tagIn { from{transform:scale(0.8);opacity:0} to{transform:scale(1);opacity:1} }
  .tag-remove { cursor:pointer; opacity:0.6; transition:opacity 0.2s; font-size:1rem; line-height:1; }
  .tag-remove:hover { opacity:1; }
  .moderation-note { font-size:0.8rem; color:var(--text-dim); margin-top:16px; display:flex; align-items:center; justify-content:center; gap:6px; }

  /* ‚ïê‚ïê‚ïê FEATURES ‚ïê‚ïê‚ïê */
  .features { max-width:1200px; margin:60px auto 0; padding:0 40px 80px; display:grid; grid-template-columns:repeat(4,1fr); gap:16px; }
  .feature { background:var(--surface); border:1px solid var(--border); border-radius:var(--radius); padding:28px 24px; text-align:center; transition:transform 0.3s,border-color 0.3s; }
  .feature:hover { transform:translateY(-3px); border-color:rgba(255,255,255,0.1); }
  .feature-icon { font-size:1.6rem; margin-bottom:12px; width:52px; height:52px; display:flex; align-items:center; justify-content:center; margin:0 auto 12px; background:rgba(108,92,231,0.08); border-radius:14px; }
  .feature-title { font-weight:600; font-size:0.95rem; margin-bottom:6px; }
  .feature-desc { font-size:0.8rem; color:var(--text-dim); line-height:1.5; }

  /* ‚ïê‚ïê‚ïê FAQ ‚ïê‚ïê‚ïê */
  .faq { max-width:700px; margin:0 auto; padding:0 40px 100px; }
  .faq h2 { font-size:2rem; font-weight:800; text-align:center; margin-bottom:40px; letter-spacing:-0.5px; }
  .faq-item { border-bottom:1px solid var(--border); padding:20px 0; }
  .faq-q { font-weight:600; font-size:1rem; cursor:pointer; display:flex; justify-content:space-between; align-items:center; gap:16px; user-select:none; }
  .faq-q:hover { color:var(--accent-glow); }
  .faq-arrow { font-size:1.2rem; transition:transform 0.3s; flex-shrink:0; color:var(--text-dim); }
  .faq-item.open .faq-arrow { transform:rotate(180deg); }
  .faq-a { max-height:0; overflow:hidden; transition:max-height 0.35s ease,padding 0.35s ease; color:var(--text-dim); font-size:0.9rem; line-height:1.7; }
  .faq-item.open .faq-a { max-height:300px; padding-top:14px; }
  footer { border-top:1px solid var(--border); padding:24px 40px; text-align:center; font-size:0.8rem; color:var(--text-dim); max-width:1200px; margin:0 auto; }
  footer a { color:var(--text-dim); text-decoration:none; margin:0 12px; transition:color 0.2s; }
  footer a:hover { color:var(--text); }

  /* ‚ïê‚ïê‚ïê CHAT PAGE ‚ïê‚ïê‚ïê */
  .chat-nav { display:flex; align-items:center; justify-content:space-between; padding:12px 20px; background:var(--surface); border-bottom:1px solid var(--border); flex-shrink:0; }
  .chat-nav .logo { font-size:1.2rem; }
  .chat-nav .logo-icon { width:28px; height:28px; font-size:0.9rem; border-radius:8px; }
  .chat-status { display:flex; align-items:center; gap:8px; font-size:0.85rem; color:var(--text-dim); }
  .chat-status .status-indicator { width:8px; height:8px; border-radius:50%; }
  .chat-status .status-indicator.searching { background:#f39c12; animation:pulse 1s infinite; }
  .chat-status .status-indicator.connected { background:var(--green); box-shadow:0 0 6px var(--green); }
  .chat-status .status-indicator.disconnected { background:#e84393; }

  .chat-main { flex:1; display:flex; min-height:0; }

  /* Video Area */
  .video-area { flex:1; display:flex; flex-direction:column; background:#08080d; position:relative; }
  .video-grid { flex:1; display:grid; grid-template-columns:1fr 1fr; gap:2px; background:#000; min-height:0; }
  .vid-box { position:relative; background:#0a0a12; overflow:hidden; }
  .vid-box video { width:100%; height:100%; object-fit:cover; display:block; }
  .vid-label { position:absolute; bottom:12px; left:12px; font-size:0.7rem; font-weight:600; background:rgba(0,0,0,0.65); backdrop-filter:blur(6px); padding:4px 12px; border-radius:100px; letter-spacing:0.5px; z-index:2; text-transform:uppercase; }
  .vid-placeholder { display:flex; flex-direction:column; align-items:center; justify-content:center; height:100%; color:var(--text-dim); font-size:0.85rem; gap:8px; }
  .vid-placeholder-icon { font-size:3rem; opacity:0.3; }

  /* Controls Bar */
  .controls-bar { display:flex; align-items:center; justify-content:center; gap:12px; padding:14px 20px; background:var(--surface); border-top:1px solid var(--border); flex-shrink:0; }
  .ctrl-btn { width:46px; height:46px; border-radius:50%; border:1px solid var(--border); background:var(--surface-2); color:var(--text); font-size:1.1rem; cursor:pointer; display:flex; align-items:center; justify-content:center; transition:all 0.2s; }
  .ctrl-btn:hover { background:rgba(108,92,231,0.15); border-color:var(--accent); }
  .ctrl-btn.on { background:var(--accent); border-color:var(--accent); }
  .ctrl-btn.off { background:rgba(232,67,147,0.15); border-color:#e84393; color:#e84393; }
  .ctrl-btn.end { background:#e84393; border-color:#e84393; color:#fff; }
  .ctrl-btn.end:hover { background:#d63384; }
  .ctrl-btn.next { background:var(--accent); border-color:var(--accent); color:#fff; padding:0 20px; border-radius:23px; width:auto; font-weight:600; font-size:0.85rem; font-family:'Outfit',sans-serif; gap:6px; }
  .ctrl-btn.next:hover { background:#7c6ff0; }

  /* Sidebar Chat */
  .chat-sidebar { width:320px; display:flex; flex-direction:column; background:var(--surface); border-left:1px solid var(--border); }
  .chat-sidebar-header { padding:14px 16px; border-bottom:1px solid var(--border); font-weight:600; font-size:0.9rem; display:flex; align-items:center; justify-content:space-between; }
  .chat-messages-list { flex:1; overflow-y:auto; padding:12px; display:flex; flex-direction:column; gap:8px; }
  .chat-bubble { max-width:85%; padding:10px 14px; border-radius:14px; font-size:0.85rem; line-height:1.5; animation:msgIn 0.25s ease; }
  @keyframes msgIn { from{transform:translateY(6px);opacity:0} to{transform:translateY(0);opacity:1} }
  .chat-bubble.stranger { background:var(--surface-2); align-self:flex-start; border-bottom-left-radius:4px; }
  .chat-bubble.you { background:var(--accent); align-self:flex-end; border-bottom-right-radius:4px; }
  .chat-bubble .bubble-label { font-size:0.65rem; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; opacity:0.5; margin-bottom:2px; }
  .chat-bubble.system { background:rgba(0,230,118,0.08); border:1px solid rgba(0,230,118,0.1); color:var(--green); align-self:center; text-align:center; font-size:0.8rem; border-radius:10px; max-width:100%; }
  .chat-input-bar { display:flex; gap:8px; padding:12px; border-top:1px solid var(--border); }
  .chat-input-bar input { flex:1; background:var(--surface-2); border:1px solid var(--border); border-radius:10px; padding:10px 14px; color:var(--text); font-family:'Outfit',sans-serif; font-size:0.85rem; outline:none; transition:border-color 0.2s; }
  .chat-input-bar input:focus { border-color:var(--accent); }
  .chat-input-bar button { background:var(--accent); border:none; color:#fff; border-radius:10px; padding:10px 18px; font-family:'Outfit',sans-serif; font-weight:600; font-size:0.85rem; cursor:pointer; transition:background 0.2s; }
  .chat-input-bar button:hover { background:#7c6ff0; }

  /* Report Modal */
  .report-overlay { position:fixed; inset:0; background:rgba(0,0,0,0.6); backdrop-filter:blur(6px); z-index:200; display:none; align-items:center; justify-content:center; }
  .report-overlay.active { display:flex; }
  .report-box { background:var(--surface); border:1px solid var(--border); border-radius:20px; padding:32px; max-width:400px; width:90%; animation:slideUp 0.3s ease; }
  @keyframes slideUp { from{transform:translateY(20px);opacity:0} to{transform:translateY(0);opacity:1} }
  .report-box h3 { font-size:1.2rem; margin-bottom:16px; }
  .report-option { display:block; width:100%; text-align:left; background:var(--surface-2); border:1px solid var(--border); border-radius:10px; padding:12px 16px; color:var(--text); font-family:'Outfit',sans-serif; font-size:0.9rem; cursor:pointer; margin-bottom:8px; transition:all 0.2s; }
  .report-option:hover { border-color:var(--accent); background:rgba(108,92,231,0.08); }
  .report-cancel { display:block; width:100%; text-align:center; background:none; border:none; color:var(--text-dim); font-family:'Outfit',sans-serif; font-size:0.85rem; cursor:pointer; margin-top:8px; padding:8px; }
  .report-cancel:hover { color:var(--text); }

  /* ‚ïê‚ïê‚ïê RESPONSIVE ‚Äî TABLET ‚ïê‚ïê‚ïê */
  @media(max-width:900px){
    .chat-sidebar { width: 260px; }
  }

  /* ‚ïê‚ïê‚ïê RESPONSIVE ‚Äî MOBILE (768px) ‚ïê‚ïê‚ïê */
  @media(max-width:768px){
    /* Landing page */
    nav { padding:16px 20px; }
    .logo { font-size:1.3rem; }
    .logo-icon { width:30px; height:30px; font-size:0.9rem; border-radius:8px; }
    .online-badge { padding:6px 12px; font-size:0.8rem; }
    .hero { padding:40px 20px 30px; }
    .hero h1 { font-size:2.6rem; letter-spacing:-1px; }
    .hero p { font-size:1rem; margin-bottom:32px; }
    .mode-cards { gap:14px; }
    .mode-card { padding:24px 32px; min-width:160px; }
    .mode-card-icon { font-size:2rem; margin-bottom:8px; }
    .mode-card-title { font-size:1.1rem; }
    .features { grid-template-columns:repeat(2,1fr); padding:0 20px 50px; gap:10px; }
    .feature { padding:20px 16px; }
    .feature-icon { width:44px; height:44px; font-size:1.3rem; }
    .faq { padding:0 20px 60px; }
    .faq h2 { font-size:1.5rem; margin-bottom:28px; }
    .interests-section { margin:0 auto 16px; }
    footer { padding:20px; }

    /* Chat page ‚Äî mobile layout */
    .chat-nav { padding:8px 12px; }
    .chat-nav .logo { font-size:1rem; gap:6px; }
    .chat-nav .logo-icon { width:24px; height:24px; font-size:0.75rem; border-radius:6px; }
    .chat-status { font-size:0.75rem; }
    .chat-main { flex-direction:column; position:relative; }
    .video-area { flex:1; display:flex; flex-direction:column; }

    /* Mobile video: stranger fills screen, you = small floating pip */
    .video-grid {
      grid-template-columns:1fr;
      grid-template-rows:1fr;
      flex:1;
      position:relative;
    }
    .video-grid .vid-box:first-child {
      /* Your video = floating picture-in-picture */
      position:absolute;
      top:12px; right:12px;
      width:110px; height:150px;
      border-radius:14px;
      border:2px solid rgba(255,255,255,0.15);
      z-index:10;
      box-shadow:0 4px 20px rgba(0,0,0,0.5);
    }
    .video-grid .vid-box:first-child .vid-label { display:none; }
    .video-grid .vid-box:last-child {
      /* Stranger video = full area */
      grid-row:1; grid-column:1;
    }

    /* Controls bar ‚Äî mobile */
    .controls-bar {
      padding:10px 16px;
      gap:10px;
      background:rgba(18,18,26,0.95);
      backdrop-filter:blur(10px);
      padding-bottom: calc(10px + env(safe-area-inset-bottom, 0px));
    }
    .ctrl-btn { width:44px; height:44px; font-size:1rem; }
    .ctrl-btn.next { padding:0 16px; font-size:0.8rem; }

    /* Chat sidebar ‚Äî hidden by default, slide up as overlay */
    .chat-sidebar {
      display:none;
      position:fixed;
      bottom:0; left:0; right:0;
      height:55vh;
      z-index:80;
      border-radius:20px 20px 0 0;
      border:none;
      border-top:1px solid var(--border);
      background:var(--surface);
      flex-direction:column;
      animation:slideUpChat 0.3s ease;
    }
    @keyframes slideUpChat {
      from { transform:translateY(100%); }
      to { transform:translateY(0); }
    }
    @keyframes slideDownChat {
      from { transform:translateY(0); }
      to { transform:translateY(100%); }
    }
    .chat-sidebar.mobile-open {
      display:flex;
    }
    .chat-sidebar-header {
      padding:12px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      position:relative;
    }
    /* Drag handle indicator */
    .chat-sidebar-header::before {
      content:'';
      position:absolute;
      top:6px; left:50%;
      transform:translateX(-50%);
      width:36px; height:4px;
      background:rgba(255,255,255,0.15);
      border-radius:2px;
    }
    .chat-input-bar { padding-bottom:calc(12px + env(safe-area-inset-bottom, 0px)); }
  }

  /* ‚ïê‚ïê‚ïê RESPONSIVE ‚Äî SMALL PHONES (480px) ‚ïê‚ïê‚ïê */
  @media(max-width:480px){
    .hero h1 { font-size:2.2rem; }
    .hero p { font-size:0.9rem; }
    .features { grid-template-columns:1fr 1fr; gap:8px; }
    .feature { padding:16px 12px; }
    .feature-title { font-size:0.85rem; }
    .feature-desc { font-size:0.7rem; }
    .mode-cards { flex-direction:column; align-items:center; }
    .or-divider { margin:-6px 0; }
    .mode-card { min-width:auto; width:100%; max-width:280px; padding:20px 28px; }
    .video-grid .vid-box:first-child { width:90px; height:120px; top:8px; right:8px; }
    .controls-bar { gap:8px; padding:8px 12px; }
    .ctrl-btn { width:40px; height:40px; font-size:0.95rem; }
    .ctrl-btn.next { padding:0 12px; font-size:0.75rem; }
  }

  /* ‚ïê‚ïê‚ïê MOBILE CHAT TOGGLE BUTTON ‚ïê‚ïê‚ïê */
  .mobile-chat-toggle {
    display:none;
    position:fixed;
    bottom:76px; right:16px;
    z-index:50;
    width:52px; height:52px;
    border-radius:50%;
    background:var(--accent);
    border:2px solid rgba(255,255,255,0.1);
    color:#fff;
    font-size:1.2rem;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    box-shadow:0 4px 24px rgba(108,92,231,0.5);
    transition:transform 0.2s, background 0.2s;
    -webkit-tap-highlight-color:transparent;
  }
  .mobile-chat-toggle:active { transform:scale(0.9); }
  .mobile-chat-toggle .chat-badge {
    position:absolute;
    top:-2px; right:-2px;
    width:18px; height:18px;
    background:var(--red);
    border-radius:50%;
    font-size:0.6rem;
    font-weight:700;
    display:none;
    align-items:center;
    justify-content:center;
    border:2px solid var(--bg);
  }
  .mobile-chat-toggle .chat-badge.has-msg {
    display:flex;
  }

  /* Mobile close button inside sidebar */
  .mobile-chat-close {
    display:none;
    background:none; border:none;
    color:var(--text-dim);
    font-size:1.3rem;
    cursor:pointer;
    padding:4px 8px;
    border-radius:8px;
    -webkit-tap-highlight-color:transparent;
  }
  .mobile-chat-close:active { background:var(--surface-2); }

  @media(max-width:768px){
    .mobile-chat-toggle { display:flex; }
    .mobile-chat-close { display:block; }
    /* Adjust toggle position when controls have safe area */
    .mobile-chat-toggle {
      bottom:calc(76px + env(safe-area-inset-bottom, 0px));
    }
  }

  /* ‚ïê‚ïê‚ïê LANDSCAPE MOBILE ‚ïê‚ïê‚ïê */
  @media(max-height:500px) and (orientation:landscape){
    .video-grid {
      grid-template-columns:1fr 1fr;
      grid-template-rows:1fr;
    }
    .video-grid .vid-box:first-child {
      position:static;
      width:auto; height:auto;
      border:none; border-radius:0;
      box-shadow:none;
    }
    .video-grid .vid-box:first-child .vid-label { display:block; }
    .controls-bar { padding:6px 12px; }
    .ctrl-btn { width:36px; height:36px; font-size:0.85rem; }
    .chat-nav { padding:4px 12px; }
  }
</style>
</head>
<body>

<div class="bg-orbs"><div class="orb"></div><div class="orb"></div><div class="orb"></div></div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LANDING PAGE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page active" id="pageLanding">
  <nav>
    <div class="logo"><div class="logo-icon">üí¨</div>MingleNow</div>
    <div class="online-badge"><span class="online-dot"></span><span id="onlineCount">0</span> online</div>
  </nav>

  <section class="hero">
    <h1>Chat with<br>Strangers</h1>
    <p>Meet someone new in seconds. Random video or text chats ‚Äî simple, fast, and anonymous. Ready to start mingling?</p>
    <div class="mode-cards">
      <a class="mode-card" onclick="startChat('video')">
        <div class="mode-card-icon">üé•</div><div class="mode-card-title">Video Chat</div><div class="mode-card-sub">Face-to-face with camera & mic</div>
      </a>
      <div class="or-divider">OR</div>
      <a class="mode-card" onclick="startChat('text')">
        <div class="mode-card-icon">üí¨</div><div class="mode-card-title">Text Chat</div><div class="mode-card-sub">Type your way to a conversation</div>
      </a>
    </div>
    <div class="interests-section">
      <div class="interests-label">What do you want to talk about? (optional)</div>
      <div class="interests-input-wrap" id="interestsWrap">
        <input type="text" id="interestInput" placeholder="Add interests like 'gaming', 'music', 'anime'..." />
      </div>
    </div>
    <div class="moderation-note">üí¨ Chats are moderated. Please keep it respectful.</div>
  </section>

  <div class="features">
    <div class="feature"><div class="feature-icon">üéØ</div><div class="feature-title">Interest Matching</div><div class="feature-desc">Paired with people who share your interests</div></div>
    <div class="feature"><div class="feature-icon">üîí</div><div class="feature-title">Moderation</div><div class="feature-desc">Report & block to keep the community safe</div></div>
    <div class="feature"><div class="feature-icon">üåç</div><div class="feature-title">Global</div><div class="feature-desc">Connect with people from around the world</div></div>
    <div class="feature"><div class="feature-icon">‚ö°</div><div class="feature-title">Instant</div><div class="feature-desc">No sign-up needed. Start chatting now</div></div>
  </div>

  <section class="faq">
    <h2>Frequently Asked Questions</h2>
    <div class="faq-item"><div class="faq-q" onclick="this.parentElement.classList.toggle('open')">How does interest matching work?<span class="faq-arrow">‚ñæ</span></div><div class="faq-a">Add topics you enjoy. Our system prioritizes pairing you with people who listed similar interests, increasing the chances of relevant, engaging conversations.</div></div>
    <div class="faq-item"><div class="faq-q" onclick="this.parentElement.classList.toggle('open')">How do you keep chats safe?<span class="faq-arrow">‚ñæ</span></div><div class="faq-a">We provide report and block tools in every chat. Reported users are logged and repeat offenders are blocked. Please use your own judgment in online interactions.</div></div>
    <div class="faq-item"><div class="faq-q" onclick="this.parentElement.classList.toggle('open')">Can I use this on my phone?<span class="faq-arrow">‚ñæ</span></div><div class="faq-a">Yes! MingleNow works in any modern browser on phones, tablets, and desktops ‚Äî no app required.</div></div>
    <div class="faq-item"><div class="faq-q" onclick="this.parentElement.classList.toggle('open')">Is it free?<span class="faq-arrow">‚ñæ</span></div><div class="faq-a">Completely free. No hidden fees, no account needed.</div></div>
  </section>

  <footer><div>¬© 2026 MingleNow</div><div style="margin-top:8px"><a href="#">Blog</a><a href="#">Rules</a><a href="#">Terms</a><a href="#">Privacy</a></div></footer>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CHAT PAGE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page page-chat" id="pageChat">
  <div class="chat-nav">
    <div class="logo" onclick="goHome()"><div class="logo-icon">üí¨</div>MingleNow</div>
    <div class="chat-status">
      <span class="status-indicator searching" id="statusDot"></span>
      <span id="statusText">Connecting...</span>
    </div>
    <div class="online-badge" style="font-size:0.8rem;padding:6px 12px">
      <span class="online-dot"></span><span id="onlineCount2">0</span>
    </div>
  </div>

  <div class="chat-main">
    <div class="video-area" id="videoArea">
      <div class="video-grid" id="videoGrid">
        <div class="vid-box">
          <video id="localVideo" autoplay muted playsinline></video>
          <div class="vid-label">You</div>
          <div class="vid-placeholder" id="localPlaceholder" style="display:none"><div class="vid-placeholder-icon">üì∑</div><div>Camera off</div></div>
        </div>
        <div class="vid-box">
          <video id="remoteVideo" autoplay playsinline style="display:none"></video>
          <div class="vid-label">Stranger</div>
          <div class="vid-placeholder" id="remotePlaceholder"><div class="vid-placeholder-icon">üë§</div><div id="remotePlaceholderText">Searching...</div></div>
        </div>
      </div>
      <div class="controls-bar">
        <button class="ctrl-btn on" id="btnMic" onclick="toggleMic()" title="Microphone">üé§</button>
        <button class="ctrl-btn on" id="btnCam" onclick="toggleCam()" title="Camera">üì∑</button>
        <button class="ctrl-btn end" onclick="goHome()" title="Stop">‚úï</button>
        <button class="ctrl-btn next" onclick="skipNext()" title="Next">‚è≠ Next</button>
        <button class="ctrl-btn" onclick="openReport()" title="Report" style="font-size:0.9rem">üö©</button>
      </div>
    </div>

    <div class="chat-sidebar" id="chatSidebar">
      <div class="chat-sidebar-header">
        <span>Chat</span>
        <span style="font-size:0.75rem;color:var(--text-dim)" id="matchInfo"></span>
        <button class="mobile-chat-close" onclick="toggleMobileChat()">‚úï</button>
      </div>
      <div class="chat-messages-list" id="chatMessages"></div>
      <div class="chat-input-bar">
        <input type="text" id="chatInput" placeholder="Type a message..." onkeydown="if(event.key==='Enter')sendChatMessage()" />
        <button onclick="sendChatMessage()">Send</button>
      </div>
    </div>
  </div>

  <button class="mobile-chat-toggle" id="mobileChatToggle" onclick="toggleMobileChat()">üí¨<span class="chat-badge" id="chatBadge">!</span></button>
</div>

<!-- Report Modal -->
<div class="report-overlay" id="reportOverlay">
  <div class="report-box">
    <h3>üö© Report Stranger</h3>
    <button class="report-option" onclick="submitReport('Inappropriate behavior')">Inappropriate behavior</button>
    <button class="report-option" onclick="submitReport('Nudity / Sexual content')">Nudity / Sexual content</button>
    <button class="report-option" onclick="submitReport('Harassment / Bullying')">Harassment / Bullying</button>
    <button class="report-option" onclick="submitReport('Spam')">Spam</button>
    <button class="report-option" onclick="submitReport('Underage user')">Underage user</button>
    <button class="report-cancel" onclick="closeReport()">Cancel</button>
  </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CONFIG ‚Äî Change this to your server URL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const SIGNALING_SERVER = window.location.hostname === 'localhost'
  ? 'ws://localhost:3001'
  : 'wss://YOUR-SERVER-URL.railway.app';  // ‚Üê REPLACE THIS after deploying server

const ICE_SERVERS = [
  { urls: 'stun:stun.l.google.com:19302' },
  { urls: 'stun:stun1.l.google.com:19302' },
  { urls: 'stun:stun2.l.google.com:19302' },
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let ws = null;
let pc = null;               // RTCPeerConnection
let localStream = null;
let chatMode = 'video';       // 'video' | 'text'
let micOn = true, camOn = true;
let isConnected = false;
let myId = null;
let interests = [];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INTEREST TAGS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const interestInput = document.getElementById('interestInput');
const interestsWrap = document.getElementById('interestsWrap');

interestInput.addEventListener('keydown', (e) => {
  if (e.key === 'Enter' && interestInput.value.trim()) {
    e.preventDefault();
    const val = interestInput.value.trim().toLowerCase();
    if (!interests.includes(val) && interests.length < 8) {
      interests.push(val);
      const tag = document.createElement('span');
      tag.className = 'tag';
      tag.innerHTML = `${val}<span class="tag-remove" onclick="removeInterest(this,'${val}')">√ó</span>`;
      interestsWrap.insertBefore(tag, interestInput);
    }
    interestInput.value = '';
  }
});

function removeInterest(el, val) {
  interests = interests.filter(i => i !== val);
  el.parentElement.remove();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NAVIGATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showPage(id) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function goHome() {
  cleanup();
  showPage('pageLanding');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// START CHAT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function startChat(mode) {
  chatMode = mode;

  // Get media for video mode
  if (mode === 'video') {
    try {
      const isMobile = window.innerWidth <= 768;
      localStream = await navigator.mediaDevices.getUserMedia({
        video: {
          width: { ideal: isMobile ? 480 : 1280 },
          height: { ideal: isMobile ? 640 : 720 },
          facingMode: 'user',
          frameRate: { ideal: isMobile ? 24 : 30 }
        },
        audio: {
          echoCancellation: true,
          noiseSuppression: true,
          autoGainControl: true
        }
      });
      document.getElementById('localVideo').srcObject = localStream;
      document.getElementById('localVideo').style.display = 'block';
      document.getElementById('localPlaceholder').style.display = 'none';
      micOn = true; camOn = true;
      updateMediaBtns();
    } catch (err) {
      alert('Camera/microphone access is required for video chat. Please allow access and try again.');
      return;
    }
  } else {
    // Text-only: hide video grid, show expanded chat
    document.getElementById('videoArea').style.display = 'none';
    document.getElementById('chatSidebar').style.flex = '1';
  }

  showPage('pageChat');
  setStatus('searching', 'Connecting to server...');
  connectWebSocket();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// WEBSOCKET
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function connectWebSocket() {
  if (ws && ws.readyState <= 1) ws.close();

  ws = new WebSocket(SIGNALING_SERVER);

  ws.onopen = () => {
    setStatus('searching', 'Looking for someone...');
    ws.send(JSON.stringify({ type: 'join_queue', interests }));
  };

  ws.onmessage = (event) => {
    const msg = JSON.parse(event.data);
    handleSignalingMessage(msg);
  };

  ws.onclose = () => {
    if (isConnected) {
      setStatus('disconnected', 'Disconnected');
      addSystemMessage('Connection to server lost. Click Next to reconnect.');
    }
  };

  ws.onerror = () => {
    setStatus('disconnected', 'Connection error');
    addSystemMessage('Could not connect to server. Make sure the signaling server is running.');
  };
}

function wsSend(data) {
  if (ws && ws.readyState === 1) ws.send(JSON.stringify(data));
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SIGNALING HANDLER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function handleSignalingMessage(msg) {
  switch (msg.type) {
    case 'welcome':
      myId = msg.id;
      updateOnlineCount(msg.online);
      break;

    case 'online_count':
      updateOnlineCount(msg.count);
      break;

    case 'waiting':
      setStatus('searching', `Searching... (${msg.position} in queue)`);
      break;

    case 'matched':
      isConnected = true;
      setStatus('connected', 'Connected!');

      const sharedText = msg.sharedInterests?.length
        ? `Shared: ${msg.sharedInterests.join(', ')}`
        : '';
      document.getElementById('matchInfo').textContent = sharedText;

      if (msg.sharedInterests?.length) {
        addSystemMessage(`üéØ You both like: ${msg.sharedInterests.join(', ')}`);
      } else {
        addSystemMessage('üéâ You\'re connected with a stranger!');
      }

      document.getElementById('remotePlaceholderText').textContent = 'Connecting video...';

      if (chatMode === 'video') {
        createPeerConnection();
        if (msg.role === 'initiator') {
          const offer = await pc.createOffer();
          await pc.setLocalDescription(offer);
          wsSend({ type: 'rtc_offer', sdp: offer.sdp });
        }
      }
      break;

    case 'rtc_offer':
      if (!pc) createPeerConnection();
      await pc.setRemoteDescription(new RTCSessionDescription({ type: 'offer', sdp: msg.sdp }));
      const answer = await pc.createAnswer();
      await pc.setLocalDescription(answer);
      wsSend({ type: 'rtc_answer', sdp: answer.sdp });
      break;

    case 'rtc_answer':
      if (pc) await pc.setRemoteDescription(new RTCSessionDescription({ type: 'answer', sdp: msg.sdp }));
      break;

    case 'rtc_ice_candidate':
      if (pc && msg.candidate) {
        try {
          await pc.addIceCandidate(new RTCIceCandidate(msg));
        } catch (e) { /* ignore */ }
      }
      break;

    case 'chat_message':
      addChatBubble('stranger', msg.text);
      notifyMobileChat();
      break;

    case 'partner_disconnected':
      isConnected = false;
      closePeerConnection();
      setStatus('disconnected', 'Stranger disconnected');
      addSystemMessage('Stranger has disconnected.');
      document.getElementById('remotePlaceholderText').textContent = 'Disconnected';
      document.getElementById('remoteVideo').style.display = 'none';
      document.getElementById('remotePlaceholder').style.display = 'flex';
      break;

    case 'report_confirmed':
      addSystemMessage('‚úÖ Report submitted. The stranger has been disconnected.');
      break;

    case 'ping':
      wsSend({ type: 'pong' });
      break;
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// WEBRTC
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function createPeerConnection() {
  closePeerConnection();

  pc = new RTCPeerConnection({ iceServers: ICE_SERVERS });

  // Add local tracks
  if (localStream) {
    localStream.getTracks().forEach(track => pc.addTrack(track, localStream));
  }

  // ICE candidates
  pc.onicecandidate = (event) => {
    if (event.candidate) {
      wsSend({
        type: 'rtc_ice_candidate',
        candidate: event.candidate.candidate,
        sdpMid: event.candidate.sdpMid,
        sdpMLineIndex: event.candidate.sdpMLineIndex,
      });
    }
  };

  // Remote stream
  pc.ontrack = (event) => {
    const remoteVideo = document.getElementById('remoteVideo');
    if (event.streams && event.streams[0]) {
      remoteVideo.srcObject = event.streams[0];
    } else {
      const stream = new MediaStream();
      stream.addTrack(event.track);
      remoteVideo.srcObject = stream;
    }
    remoteVideo.style.display = 'block';
    document.getElementById('remotePlaceholder').style.display = 'none';
  };

  pc.onconnectionstatechange = () => {
    if (pc.connectionState === 'failed' || pc.connectionState === 'disconnected') {
      document.getElementById('remoteVideo').style.display = 'none';
      document.getElementById('remotePlaceholder').style.display = 'flex';
      document.getElementById('remotePlaceholderText').textContent = 'Connection lost';
    }
  };
}

function closePeerConnection() {
  if (pc) {
    pc.close();
    pc = null;
  }
  document.getElementById('remoteVideo').srcObject = null;
  document.getElementById('remoteVideo').style.display = 'none';
  document.getElementById('remotePlaceholder').style.display = 'flex';
  document.getElementById('remotePlaceholderText').textContent = 'Searching...';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CONTROLS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function toggleMic() {
  if (!localStream) return;
  micOn = !micOn;
  localStream.getAudioTracks().forEach(t => t.enabled = micOn);
  updateMediaBtns();
}

function toggleCam() {
  if (!localStream) return;
  camOn = !camOn;
  localStream.getVideoTracks().forEach(t => t.enabled = camOn);
  document.getElementById('localVideo').style.display = camOn ? 'block' : 'none';
  document.getElementById('localPlaceholder').style.display = camOn ? 'none' : 'flex';
  updateMediaBtns();
}

function updateMediaBtns() {
  const mic = document.getElementById('btnMic');
  const cam = document.getElementById('btnCam');
  mic.textContent = micOn ? 'üé§' : 'üîá';
  mic.className = `ctrl-btn ${micOn ? 'on' : 'off'}`;
  cam.textContent = camOn ? 'üì∑' : 'üö´';
  cam.className = `ctrl-btn ${camOn ? 'on' : 'off'}`;
}

function skipNext() {
  isConnected = false;
  closePeerConnection();
  document.getElementById('chatMessages').innerHTML = '';
  document.getElementById('matchInfo').textContent = '';
  unreadMobile = 0;
  document.getElementById('chatBadge').classList.remove('has-msg');
  setStatus('searching', 'Looking for someone...');
  wsSend({ type: 'skip', interests });
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CHAT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function addChatBubble(who, text) {
  const list = document.getElementById('chatMessages');
  const div = document.createElement('div');
  div.className = `chat-bubble ${who}`;
  const label = document.createElement('div');
  label.className = 'bubble-label';
  label.textContent = who === 'you' ? 'You' : 'Stranger';
  div.appendChild(label);
  div.appendChild(document.createTextNode(text));
  list.appendChild(div);
  list.scrollTop = list.scrollHeight;
}

function addSystemMessage(text) {
  const list = document.getElementById('chatMessages');
  const div = document.createElement('div');
  div.className = 'chat-bubble system';
  div.textContent = text;
  list.appendChild(div);
  list.scrollTop = list.scrollHeight;
}

function sendChatMessage() {
  const inp = document.getElementById('chatInput');
  const text = inp.value.trim();
  if (!text || !isConnected) return;
  addChatBubble('you', text);
  wsSend({ type: 'chat_message', text });
  inp.value = '';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// REPORT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function openReport() {
  document.getElementById('reportOverlay').classList.add('active');
}
function closeReport() {
  document.getElementById('reportOverlay').classList.remove('active');
}
function submitReport(reason) {
  wsSend({ type: 'report', reason });
  closeReport();
  isConnected = false;
  closePeerConnection();
  setStatus('disconnected', 'Reported & disconnected');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// UI HELPERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function setStatus(state, text) {
  const dot = document.getElementById('statusDot');
  dot.className = `status-indicator ${state}`;
  document.getElementById('statusText').textContent = text;
}

function updateOnlineCount(n) {
  const str = n.toLocaleString();
  const el1 = document.getElementById('onlineCount');
  const el2 = document.getElementById('onlineCount2');
  if (el1) el1.textContent = str;
  if (el2) el2.textContent = str;
}

function toggleMobileChat() {
  const sidebar = document.getElementById('chatSidebar');
  const badge = document.getElementById('chatBadge');
  const isOpen = sidebar.classList.contains('mobile-open');

  if (isOpen) {
    sidebar.style.animation = 'slideDownChat 0.25s ease forwards';
    setTimeout(() => {
      sidebar.classList.remove('mobile-open');
      sidebar.style.animation = '';
    }, 240);
  } else {
    sidebar.classList.add('mobile-open');
    sidebar.style.animation = 'slideUpChat 0.3s ease';
    badge.classList.remove('has-msg');
    // Focus input on open
    setTimeout(() => document.getElementById('chatInput').focus(), 350);
  }
}

// Notify on mobile when chat is closed and message arrives
let unreadMobile = 0;
function notifyMobileChat() {
  const sidebar = document.getElementById('chatSidebar');
  if (window.innerWidth <= 768 && !sidebar.classList.contains('mobile-open')) {
    unreadMobile++;
    const badge = document.getElementById('chatBadge');
    badge.textContent = unreadMobile > 9 ? '9+' : unreadMobile;
    badge.classList.add('has-msg');
    // Vibrate on supported devices
    if (navigator.vibrate) navigator.vibrate(100);
  }
}

// Swipe down to close chat on mobile
(function() {
  let startY = 0, currentY = 0, dragging = false;
  const sidebar = document.getElementById('chatSidebar');

  sidebar.addEventListener('touchstart', (e) => {
    const header = sidebar.querySelector('.chat-sidebar-header');
    if (e.target === header || header.contains(e.target)) {
      startY = e.touches[0].clientY;
      dragging = true;
    }
  }, { passive: true });

  sidebar.addEventListener('touchmove', (e) => {
    if (!dragging) return;
    currentY = e.touches[0].clientY;
    const diff = currentY - startY;
    if (diff > 0) {
      sidebar.style.transform = `translateY(${diff}px)`;
    }
  }, { passive: true });

  sidebar.addEventListener('touchend', () => {
    if (!dragging) return;
    dragging = false;
    const diff = currentY - startY;
    if (diff > 80) {
      toggleMobileChat();
    }
    sidebar.style.transform = '';
  });
})();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CLEANUP
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function cleanup() {
  isConnected = false;
  closePeerConnection();
  if (localStream) {
    localStream.getTracks().forEach(t => t.stop());
    localStream = null;
  }
  document.getElementById('localVideo').srcObject = null;
  document.getElementById('remoteVideo').srcObject = null;
  if (ws) { ws.close(); ws = null; }
  document.getElementById('chatMessages').innerHTML = '';
  document.getElementById('matchInfo').textContent = '';
  unreadMobile = 0;
  document.getElementById('chatBadge').classList.remove('has-msg');
  // Reset layout
  document.getElementById('videoArea').style.display = '';
  document.getElementById('chatSidebar').style.flex = '';
  document.getElementById('chatSidebar').classList.remove('mobile-open');
}

// Handle page unload
window.addEventListener('beforeunload', cleanup);
</script>
</body>
</html>
